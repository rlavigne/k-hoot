<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Interactif</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/markdown-it/13.0.1/markdown-it.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/@tailwindcss/typography@0.5.10/dist/typography.min.css" rel="stylesheet">
    <link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet">
    <style>
        /* Base styles */
        body {
            background: linear-gradient(135deg, #2b0f59 0%, #1a0936 100%);
            color: white;
            margin: 0;
            padding: 0;
            min-height: 100vh;
        }

        main {
            padding: 10px;
            min-height: 100vh;
        }

        section {
            height: 100%;
            border-radius: 0 !important;
            display: flex;
            flex-direction: column;
            background: transparent !important;
            box-shadow: none !important;
        }

        #quiz {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        /* Progress and Timer Bars */
        .progress-container, .timer-container {
            width: calc(100% - 4rem);
            margin: 1rem auto;
            padding: 0;
            position: relative;
        }

        .progress-bar, .timer-container {
            height: 0.75rem !important;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 0.5rem;
            overflow: hidden;
        }

        #progress {
            height: 100%;
            width: 0;
            background: #32ab14;
            transition: width 0.3s ease;
        }

        .timer-bar {
            height: 100%;
            width: 100%;
            background: #32ab14;
            transform-origin: left;
        }

        @keyframes countdown {
            from { 
                transform: scaleX(1);
                background-color: #32ab14;
            }
            50% {
                background-color: #1368CE;
            }
            to { 
                transform: scaleX(0);
                background-color: #ffffff;
            }
        }

        /* Progress Info */
        .progress-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 2rem;
        }

        #current-score, 
        #question-counter {
            color: white;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
            font-weight: bold;
        }

        #current-score {
            font-size: 1.5rem;
        }

        #question-counter {
            font-size: 1.125rem;
        }

        /* Question Styles */
        .question {
            background-color: rgba(255, 255, 255, 0.95);
            color: #000000 !important;
            font-size: 2rem !important;
            padding: 2.5rem !important;
            margin: 1.5rem;
            border-radius: 1.5rem;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
            min-height: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-weight: bold;
            margin-bottom: 1rem;
        }

        /* Ajouter une r√®gle plus sp√©cifique pour la question */
        #question.question,
        #question.question * {
            color: #220420 !important;
        }

        /* Choices Grid */
        .choices {
            flex: 1;
            gap: 1rem !important;
            padding: 1rem;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            grid-auto-rows: minmax(min-content, 1fr);
        }

        .choice {
            margin: 0;
            display: flex;
            align-items: stretch;
            justify-content: center;
            font-size: 1.5rem;
            border-radius: 1.5rem !important;
            padding: 15px 15px 10px 15px !important;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
            color: white;
            font-weight: bold;
            border: none;
            cursor: pointer;
            transition: transform 0.2s ease !important;
            height: auto !important;
            min-height: 100px !important;
        }

        .choice > div {
            width: 100%;
            padding: 15px 15px 10px 15px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 70px;
        }

        .choice:hover {
            transform: scale(1.02) !important;
            filter: brightness(1.1);
        }

        /* Animation States */
        .choice.correct {
            animation: correctPulse 0.6s ease !important;
            background: linear-gradient(135deg, #32ab14, #26890c) !important;
            border: 3px solid #fff !important;
            box-shadow: 0 0 20px rgba(50, 171, 20, 0.5) !important;
        }

        .choice.wrong {
            animation: wrongShake 0.6s ease !important;
            background: linear-gradient(135deg, #ff4b6a, #e21b3c) !important;
            opacity: 0.7 !important;
        }

        @keyframes correctPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        @keyframes wrongShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        /* Ajouter ces styles pour le conteneur de r√©f√©rence et le bouton continuer */
        #reference-container {
            display: none;
            background: rgba(255, 255, 255, 0.1);
            padding: 1rem;
            margin: 1rem 2rem;
            border-radius: 1rem;
            text-align: center;
        }

        #reference-text {
            color: white;
            font-size: 1.1rem;
            margin-bottom: 1rem;
        }

        #continue-btn {
            background: #32ab14;
            color: white;
            padding: 0.75rem 2rem;
            border-radius: 0.5rem;
            border: none;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        #continue-btn:hover {
            background: #268f0f;
            transform: scale(1.05);
        }

        /* Loader Styles */
        .loader-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: linear-gradient(135deg, #2b0f59 0%, #1a0936 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease-out;
            text-align: center;
        }

        .loader {
            width: 48px;
            height: 48px;
            border: 5px solid #FFF;
            border-bottom-color: transparent;
            border-radius: 50%;
            display: inline-block;
            box-sizing: border-box;
            animation: rotation 1s linear infinite;
        }

        .loader-text {
            color: white;
            margin-top: 2rem;
            font-size: 1.25rem;
            font-weight: 500;
            letter-spacing: 0.5px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        @keyframes loadingDots {
            0% { content: ''; }
            25% { content: '.'; }
            50% { content: '..'; }
            75% { content: '...'; }
            100% { content: ''; }
        }

        .loader-dots::after {
            content: '';
            display: inline-block;
            width: 24px;
            text-align: left;
            animation: loadingDots 1.5s infinite;
        }

        .fade-out {
            opacity: 0;
            pointer-events: none;
        }

        #restart-btn {
            color: #ef4444;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: bold;
            transition: all 0.2s ease;
            background: transparent;
            border: none;
            cursor: pointer;
        }

        #restart-btn:hover {
            color: #b91c1c;
        }

        /* Modifier les styles d'en-t√™te */
        .text-2xl, 
        #current-score, 
        #question-counter,
        h1 {
            color: white !important;
        }

        /* Style sp√©cifique pour le titre Quiz Interactif */
        h1.text-2xl {
            font-size: 1.5rem;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
        }

        /* Styles pour le dialogue */
        .prose {
            line-height: 1.6;
        }

        .prose h3 {
            color: #1a202c;
            margin-top: 2em;
            margin-bottom: 1em;
        }

        .prose p {
            margin-bottom: 1em;
        }

        .prose section {
            margin-bottom: 2em;
        }

        /* Pour la scrollbar personnalis√©e */
        .overflow-y-auto {
            scrollbar-width: thin;
            scrollbar-color: #CBD5E0 #EDF2F7;
        }

        .overflow-y-auto::-webkit-scrollbar {
            width: 8px;
        }

        .overflow-y-auto::-webkit-scrollbar-track {
            background: #EDF2F7;
        }

        .overflow-y-auto::-webkit-scrollbar-thumb {
            background-color: #CBD5E0;
            border-radius: 4px;
        }

        /* Styles pour le markdown rendu */
        .markdown-content {
            color: #1a202c;
            line-height: 1.6;
        }

        .markdown-content h1 {
            font-size: 2rem;
            font-weight: bold;
            margin-top: 2rem;
            margin-bottom: 1rem;
            color: #1a202c !important;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 0.5rem;
        }

        .markdown-content h2 {
            font-size: 1.5rem;
            font-weight: bold;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            color: #2d3748 !important;
        }

        .markdown-content p {
            margin-bottom: 1rem;
            color: #4a5568;
        }

        .markdown-content ul {
            list-style-type: disc;
            margin-left: 1.5rem;
            margin-bottom: 1rem;
        }

        .markdown-content li {
            margin-bottom: 0.5rem;
            color: #4a5568;
        }

        .markdown-content strong {
            font-weight: bold;
            color: #2d3748;
        }

        .markdown-content em {
            font-style: italic;
        }

        .markdown-content blockquote {
            border-left: 4px solid #e2e8f0;
            padding-left: 1rem;
            margin: 1rem 0;
            color: #718096;
        }

        .markdown-content code {
            background-color: #f7fafc;
            padding: 0.2rem 0.4rem;
            border-radius: 0.25rem;
            font-family: monospace;
            font-size: 0.9em;
            color: #2d3748;
        }

        .markdown-content pre {
            background-color: #f7fafc;
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            margin: 1rem 0;
        }

        .markdown-content pre code {
            background-color: transparent;
            padding: 0;
        }

        @keyframes rotation {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">
    <div id="loader" class="loader-container">
        <div class="loader"></div>
        <div class="loader-text">
            Chargement du quiz<span class="loader-dots"></span>
        </div>
    </div>
    <main class="container mx-auto">
        <section class="bg-white shadow-lg">
            <div class="flex justify-between items-center px-4">
                <h1 class="text-2xl font-bold text-center text-blue-600">Quiz Interactif</h1>
                <div class="flex gap-4">
                    <button id="source-btn" class="text-blue-500 px-4 py-2 rounded-lg hover:text-blue-700 transition-all font-bold">
                        Source
                    </button>
                    <button id="restart-btn" class="text-red-500 px-4 py-2 rounded-lg hover:text-red-700 transition-all font-bold">
                        Recommencer
                    </button>
                </div>
            </div>
            
            <div class="progress-container mt-4">
                <div class="progress-bar bg-gray-200 rounded-full h-4">
                    <div id="progress" class="bg-blue-500 h-4 rounded-full transition-all duration-300"></div>
                </div>
                <div class="flex justify-between text-sm text-gray-600 mt-1">
                    <span id="current-score" class="text-2xl font-bold">0 points</span>
                    <span id="question-counter" class="text-lg">Question 1/63</span>
                </div>
            </div>

            <div id="quiz">
                <div class="timer-container">
                    <div class="timer-bar" id="timer-bar"></div>
                </div>
                <div class="question-container">
                    <h2 class="question text-2xl font-bold text-center p-8" id="question"></h2>
                    <div id="reference-container">
                        <p id="reference-text"></p>
                        <button id="continue-btn">Continuer</button>
                    </div>
                </div>
                <div class="choices grid grid-cols-2" id="choices"></div>
            </div>
        </section>
    </main>

    <div id="source-dialog" class="fixed inset-0 bg-black bg-opacity-50 hidden overflow-y-auto">
        <div class="min-h-screen flex items-center justify-center p-4">
            <div class="bg-white rounded-lg max-w-4xl w-full my-8">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-bold text-gray-800">Source du contenu</h2>
                        <button id="close-dialog" class="text-gray-500 hover:text-gray-700">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    <div id="source-content" class="prose max-w-none text-gray-600">
                        <!-- Le contenu sera inject√© ici via JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const QUIZ_CONFIG = {
            QUESTION_TIME: 20,
            POINTS: {
                FAST: 10,
                MEDIUM: 5,
                SLOW: 2
            }
        };

        class Quiz {
            constructor() {
                // Initialisation des √©l√©ments DOM
                this.questionElement = document.getElementById('question');
                this.choicesElement = document.getElementById('choices');
                this.scoreElement = document.getElementById('current-score');
                this.progressBar = document.getElementById('progress');
                this.questionCounterElement = document.getElementById('question-counter');
                this.loaderElement = document.getElementById('loader');

                // √âtat initial
                this.currentQuestion = null;
                this.nextQuestion = null;
                this.score = 0;
                this.questionCount = 0;
                this.totalQuestions = 63;
                this.timeLeft = 0;
                this.timerId = null;
                this.isLoading = true;
                this.loadingNextQuestion = false;

                // Ajouter l'historique
                this.questionHistory = [];

                // Initialiser le quiz
                this.initAsync();

                // Ajouter l'√©couteur pour le bouton recommencer
                document.getElementById('restart-btn').addEventListener('click', () => this.restartQuiz());
            }

            async loadNextQuestion() {
                try {
                    const response = await fetch('https://boostnet.retool.com/url/education-k-hoot-quiz-questions', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Accept': 'application/json'
                        },
                        // Ajouter l'historique dans le payload
                        body: JSON.stringify({
                            history: this.questionHistory
                        })
                    });

                    if (!response.ok) throw new Error(`Erreur r√©seau: ${response.status}`);
                    
                    const question = await response.json();
                    
                    // Ajouter la question √† l'historique
                    if (question && question.question) {
                        this.questionHistory.push(question.question);
                    }
                    
                    return question;
                } catch (error) {
                    console.error('Erreur de chargement:', error);
                    return null;
                }
            }

            async initAsync() {
                try {
                    // Charger la premi√®re question
                    this.currentQuestion = await this.loadNextQuestion();
                    // Pr√©charger la prochaine question
                    this.nextQuestion = await this.loadNextQuestion();
                    
                    if (this.currentQuestion) {
                        this.loaderElement.classList.add('fade-out');
                        setTimeout(() => {
                            this.loaderElement.style.display = 'none';
                        }, 500);

                        this.isLoading = false;
                        this.displayQuestion();
                        
                        this.choicesElement.addEventListener('click', (e) => {
                            const button = e.target.closest('button');
                            if (button && !this.isLoading) {
                                const choice = parseInt(button.dataset.choice);
                                this.checkAnswer(choice);
                            }
                        });
                    }
                } catch (error) {
                    this.handleError(error);
                }
            }

            async goToNextQuestion() {
                this.questionCount++;
                if (this.questionCount >= this.totalQuestions) {
                    this.showFinalScore();
                    return;
                }

                if (!this.nextQuestion) {
                    this.showLoader();
                    this.nextQuestion = await this.loadNextQuestion();
                }

                this.currentQuestion = this.nextQuestion;
                this.nextQuestion = null;
                
                // Pr√©charger la prochaine question en arri√®re-plan
                this.loadingNextQuestion = true;
                this.loadNextQuestion().then(question => {
                    this.nextQuestion = question;
                    this.loadingNextQuestion = false;
                });
                
                this.hideLoader();
                this.questionCounterElement.textContent = `Question ${this.questionCount + 1}/${this.totalQuestions}`;
                this.displayQuestion();
            }

            showLoader() {
                this.questionElement.style.display = 'none';
                this.choicesElement.style.display = 'none';
                
                const loaderHTML = `
                    <div class="flex flex-col items-center justify-center p-8">
                        <div class="loader"></div>
                        <div class="loader-text">
                            Chargement de la question<span class="loader-dots"></span>
                        </div>
                    </div>`;
                
                this.questionElement.insertAdjacentHTML('afterend', loaderHTML);
            }

            hideLoader() {
                // Supprimer le mini loader s'il existe
                const loader = document.querySelector('.loader')?.parentElement;
                if (loader) loader.remove();
                
                // R√©afficher la question et les choix
                this.questionElement.style.display = 'block';
                this.choicesElement.style.display = 'grid';
            }

            displayQuestion() {
                if (this.currentQuestion) {
                    this.questionElement.textContent = this.currentQuestion.question;
                    this.choicesElement.innerHTML = '';
                    
                    // Fonction pour g√©n√©rer une couleur al√©atoire en HSL
                    const generateColor = (usedHues) => {
                        // √âviter les teintes proches du vert (90-150), rouge (0-20, 340-360) et violet (270-310)
                        let hue;
                        do {
                            hue = Math.floor(Math.random() * 360);
                        } while (
                            (hue >= 90 && hue <= 150) || // Vert
                            (hue >= 340 || hue <= 20) || // Rouge
                            (hue >= 270 && hue <= 310) || // Violet
                            usedHues.some(h => Math.abs(h - hue) < 45) // Assurer un contraste minimum
                        );
                        
                        // Saturation et luminosit√© √©lev√©es pour un bon contraste
                        const saturation = 65 + Math.random() * 15; // 65-80%
                        const lightness = 45 + Math.random() * 10; // 45-55%
                        
                        return {
                            main: `hsl(${hue}, ${saturation}%, ${lightness}%)`,
                            dark: `hsl(${hue}, ${saturation}%, ${lightness - 15}%)`,
                            hue
                        };
                    };
                    
                    // G√©n√©rer 4 couleurs contrast√©es
                    const usedHues = [];
                    const colors = Array.from({length: 4}, () => {
                        const color = generateColor(usedHues);
                        usedHues.push(color.hue);
                        return [color.main, color.dark];
                    });
                    
                    // Afficher les choix dans l'ordre original
                    this.currentQuestion.choices.forEach((choice, index) => {
                        const button = document.createElement('button');
                        button.className = 'choice rounded-lg flex items-center justify-center text-xl';
                        button.style.background = `linear-gradient(135deg, ${colors[index][0]} 0%, ${colors[index][1]} 100%)`;
                        button.innerHTML = `
                            <div>
                                <div class="text-xl mb-2">${choice}</div>
                            </div>
                        `;
                        button.dataset.choice = String(index + 1);
                        this.choicesElement.appendChild(button);
                    });

                    this.startTimer();
                }
            }

            showFinalScore() {
                this.questionElement.textContent = `Quiz termin√©! Score final: ${this.score} points üëç`;
                this.choicesElement.innerHTML = '';
                // Cacher les √©l√©ments de jeu
                document.querySelector('.timer-container').style.display = 'none';
            }

            startTimer() {
                const timerBar = document.getElementById('timer-bar');
                timerBar.style.animation = 'none';
                timerBar.offsetHeight; // Force reflow
                timerBar.style.animation = `countdown ${QUIZ_CONFIG.QUESTION_TIME}s linear forwards`;
                
                this.timeLeft = QUIZ_CONFIG.QUESTION_TIME;
                
                if (this.timerId) {
                    clearInterval(this.timerId);
                }
                
                this.timerId = setInterval(() => {
                    this.timeLeft--;
                    if (this.timeLeft <= 0) {
                        this.stopTimer();
                        this.goToNextQuestion();
                    }
                }, 1000);
            }

            stopTimer() {
                clearInterval(this.timerId);
            }

            updateTimerDisplay() {
                this.timerElement.textContent = `${this.timeLeft}s`;
                const progress = (this.timeLeft / QUIZ_CONFIG.QUESTION_TIME) * 100;
                this.progressBar.style.width = `${progress}%`;
            }

            checkAnswer(choice) {
                const choiceIndex = parseInt(choice) - 1;
                const correctIndex = this.currentQuestion.correct;
                const isCorrect = choiceIndex === correctIndex;
                
                this.stopTimer();
                const timerBar = document.getElementById('timer-bar');
                timerBar.style.animationPlayState = 'paused';
                
                const buttons = this.choicesElement.querySelectorAll('.choice');
                buttons.forEach(button => {
                    button.disabled = true;
                    const buttonIndex = parseInt(button.dataset.choice) - 1;
                    
                    // R√©initialiser les styles
                    button.classList.remove('correct', 'wrong');
                    
                    if (isCorrect) {
                        // Si la r√©ponse est correcte
                        if (buttonIndex === choiceIndex) {
                            button.classList.add('correct');
                            button.style.opacity = '1';
                        } else {
                            // Les autres choix
                            button.style.opacity = '0.5';
                            button.style.border = '2px dotted white';
                            button.style.backgroundColor = 'transparent';
                            button.style.background = 'transparent';
                        }
                    } else {
                        // Si la r√©ponse est incorrecte
                        if (buttonIndex === choiceIndex) {
                            // Mauvaise r√©ponse s√©lectionn√©e
                            button.classList.add('wrong');
                            button.style.opacity = '1';
                        } else if (buttonIndex === correctIndex) {
                            // Bonne r√©ponse
                            button.classList.add('correct');
                            button.style.opacity = '1';
                        } else {
                            // Les autres choix
                            button.style.opacity = '0.5';
                            button.style.border = '2px dotted white';
                            button.style.backgroundColor = 'transparent';
                            button.style.background = 'transparent';
                        }
                    }
                });
                
                // Afficher la r√©f√©rence
                const referenceContainer = document.getElementById('reference-container');
                const referenceText = document.getElementById('reference-text');
                referenceText.textContent = this.currentQuestion.reference;
                referenceContainer.style.display = 'block';
                
                if (isCorrect) {
                    let points;
                    if (this.timeLeft >= 10) {
                        points = QUIZ_CONFIG.POINTS.FAST;
                    } else if (this.timeLeft >= 5) {
                        points = QUIZ_CONFIG.POINTS.MEDIUM;
                    } else {
                        points = QUIZ_CONFIG.POINTS.SLOW;
                    }
                    
                    const pointsFeedback = document.createElement('div');
                    pointsFeedback.className = 'points-feedback';
                    pointsFeedback.textContent = `+${points}`;
                    document.body.appendChild(pointsFeedback);
                    
                    setTimeout(() => {
                        pointsFeedback.remove();
                    }, 1000);
                    
                    this.score += points;
                    this.scoreElement.textContent = `${this.score} points`;
                    this.updateProgress();
                }
                
                // Ajouter l'√©couteur d'√©v√©nement pour le bouton continuer
                const continueBtn = document.getElementById('continue-btn');
                
                continueBtn.onclick = () => {
                    referenceContainer.style.display = 'none';
                    this.goToNextQuestion();
                };
            }

            handleError(error) {
                console.error('Erreur d√©taill√©e:', error);
                this.questionElement.textContent = 'Erreur lors du chargement du quiz. Veuillez rafra√Æchir la page.';
                this.choicesElement.innerHTML = `
                    <div class="text-center text-red-500">
                        <p>Message d'erreur: ${error.message}</p>
                        <button onclick="location.reload()" class="mt-4 px-4 py-2 bg-blue-500 text-white rounded">
                            R√©essayer
                        </button>
                    </div>
                `;
            }

            restartQuiz() {
                // Rafra√Æchir la page
                window.location.reload();
            }

            updateProgress() {
                const maxScore = this.totalQuestions * QUIZ_CONFIG.POINTS.FAST;
                const percentage = (this.score / maxScore) * 100;
                const progressPercentage = (this.questionCount / this.totalQuestions) * 100;
                
                this.progressBar.style.width = `${progressPercentage}%`;
                
                // Nouvelle logique de couleur
                let position;
                if (percentage >= 70) {
                    position = '100%'; // Vert
                } else if (percentage >= 35) {
                    position = '50%';  // Bleu
                } else {
                    position = '0%';   // Blanc
                }
                
                this.progressBar.style.backgroundPosition = `${position} 0`;
            }

            updateScore(points) {
                this.score += points;
                this.scoreDisplay.textContent = this.score;
                this.updateProgress();
            }
        }

        // Initialisation du quiz
        document.addEventListener('DOMContentLoaded', () => {
            new Quiz();

            const sourceBtn = document.getElementById('source-btn');
            const sourceDialog = document.getElementById('source-dialog');
            const closeDialog = document.getElementById('close-dialog');
            const sourceContent = document.getElementById('source-content');

            // Initialiser markdown-it
            const md = new markdownit();

            // Contenu en markdown
            const sourceText = `
# Procaryotes ou eucaryotes ?

**en quelle ann√©e le r√©gime seigneurial a-t-il √©t√© implant√© dans la colonie ?**  
- en 1627

**quelle fonction sociale les augustines assumaient-elles dans la colonie ?**  
- les h√¥pitaux (soins, sant√©)

**en quelle ann√©e la ville de trois-rivi√®res a-t-elle √©t√© fond√©e ?**  
- en 1634

**qui suis-je ? je suis la compagnie de marchands √† qui la compagnie des cent-associ√©s a c√©d√© l'administration de la colonie et le monopole de la traite des fourrures en 1645.**  
- la communaut√© des habitants

**√† quel intendant doit-on l‚Äôimplantation du r√©seau commercial qui impliquait la colonie, la france et les antilles fran√ßaises ?**  
- jean talon

**que suis-je ? je suis un imp√¥t pr√©lev√© par l'√©glise catholique.**  
- la d√Æme

**qui suis-je ? durant la deuxi√®me partie du r√©gime fran√ßais, je suis le personnage √† qui le roi a confi√© le mandat de coloniser, d'administrer et de d√©velopper la colonie.**  
- jean talon

**dans la premi√®re partie du r√©gime fran√ßais, qui √©tait responsable de l'administration, du d√©veloppement et du peuplement de la colonie ?**  
- les compagnies

**quel √©v√©nement marque le d√©but du r√©gime fran√ßais ?**  
- la fondation de qu√©bec (1608)

**dans le cadre du commerce des fourrures, quel acteur √©tait responsable de chasser les animaux et de pr√©parer les peaux ?**  
- les autochtones

**quel √©tait le nom donn√© √† l'√©tablissement de montr√©al au moment de sa fondation en 1642 ?**  
- ville-marie

**quelle √©tait la proposition faite aux soldats envoy√©s par la france en 1665 pour les convaincre de rester dans la colonie √† la fin de leur mission ?**  
- le roi offre des terres aux soldats qui demeurent en nouvelle-france.  
  les officiers de rang sup√©rieur se voient offrir des seigneuries.

**en quelle ann√©e les guerres iroquoises ont-elles commenc√© ?**  
- 1609

**quels sont les deux seuls moyens qui permettent de favoriser l'accroissement d'une population ?**  
- l'immigration et la natalit√©

**√† l'√©poque du r√©gime fran√ßais, comment appelait-on les habitants n√©s dans la colonie ?**  
- les canadiens

**dans le cadre de la politique √©conomique en vigueur durant le r√©gime fran√ßais, quelles √©taient les deux fonctions de la colonie ?**  
- fournir les ressources naturelles et acheter les produits transform√©s

**qui suis-je ? m√™me si je ne suis officiellement que le deuxi√®me intendant de la colonie, j'ai tout de m√™me √©t√© le premier √† m'y rendre pour exercer mes fonctions.**  
- jean talon

**durant le r√©gime fran√ßais, quelle √©tait l'origine de la majorit√© des esclaves de la colonie ?**  
- des autochtones (environ 2/3)

**en 1663, quel constat fait-on au sujet de l'√©tat de l'√©conomie de la colonie ?**  
- peu diversifi√©e

**en 1665, la france a envoy√© des soldats d'√©lite dans la colonie pour mettre un frein √† la menace iroquoise. combien de ces soldats ont d√©cid√© d'y demeurer √† la fin de leur mission ?**  
- environ le tiers (environ 400 militaires)

**que signifie le nom ¬´ qu√©bec ¬ª en langue algonquine ?**  
- ¬´ l'√©troitesse de la rivi√®re ¬ª ou ¬´ l√† o√π le fleuve r√©tr√©cit ¬ª

**quelle fonction sociale les ursulines assumaient-elles dans la colonie ?**  
- les √©coles (√©ducation)

**en quelle ann√©e la ville de qu√©bec a-t-elle √©t√© fond√©e ?**  
- le 3 juillet 1608

**selon l‚Äô√©tude statistique des caract√©ristiques de la population r√©alis√©e en 1665-1666, combien y avait-il d‚Äôhommes et de femmes dans la colonie ?**  
- environ 2034 hommes et environ 1181 femmes

**qui suis-je ? je suis une compagnie anglaise fond√©e √† londres, en 1670, √† la suite des voyages d‚Äôexploration effectu√©s par m√©dard chouart des groseilliers et pierre-esprit radisson.**  
- la compagnie de la baie d‚Äôhudson

**qui suis-je ? je suis une importante compagnie de commerce qui a √©t√© fond√©e en 1627.**  
- la compagnie des cent-associ√©s

**en 1665-1666, selon l‚Äô√©tude statistique des caract√©ristiques de la population, √† combien s‚Äô√©levait la population de la colonie ?**  
- 3215

**√† l‚Äô√©poque du r√©gime fran√ßais, quel √©tait le principal produit export√© par la colonie ?**  
- les fourrures

**pour quelle raison la prise de qu√©bec par les fr√®res kirke a-t-elle √©t√© d√©clar√©e ill√©gale ?**  
- parce qu‚Äôelle est survenue apr√®s la signature d‚Äôun trait√© de paix entre la france et l‚Äôangleterre, la rendant ainsi ill√©gale

**qui suis-je ? je suis la nation autochtone qui a √©t√© lourdement affect√©e par les guerres iroquoises, surtout de 1648 √† 1650.**  
- les hurons

**√† partir des ann√©es 1650, comment appelait-on ceux qui allaient r√©cup√©rer les peaux chez les autochtones et qui les rapportaient ensuite aux marchands-traiteurs de la compagnie ?**  
- les coureurs des bois

**quelles sont les ann√©es qui d√©limitent la premi√®re partie du r√©gime fran√ßais ?**  
- 1608-1663 (p√©riode du gouvernement des compagnies)

**que suis-je ? je suis un mouvement de pens√©e qui pr√©voit la soumission de l‚Äô√©glise catholique de france au roi de france plut√¥t qu‚Äôau pape.**  
- le gallicanisme


---

**qui suis-je ? je suis la communaut√© religieuse masculine qui est arriv√©e dans la colonie en 1625.**  
- les j√©suites

**qui suis-je ? je suis celui dont la t√¢che consiste √† transmettre les directives du roi aux dirigeants coloniaux.**  
- le secr√©taire d‚Äô√©tat √† la marine

**durant le r√©gime fran√ßais, quel √©tait l‚Äôobjectif de l‚Äô√©glise catholique √† l‚Äô√©gard des autochtones ?**  
- les √©vang√©liser

**parmi les trois programmes de colonisation implant√©s durant le r√©gime fran√ßais (compagnies, √©glise et √âtat), un seul a grandement contribu√© au peuplement de la colonie. lequel ?**  
- l‚Äô√©tat

**√† quelle partie du r√©gime fran√ßais doit-on associer la pr√©sence du conseil souverain ?**  
- √† la deuxi√®me partie (1663 √† 1760)

**qui suis-je ? je suis l‚Äôintendant associ√© √† l‚Äôimplantation des forges du saint-maurice et √† la mise en service de la premi√®re voie carrossable de la colonie.**  
- gilles hocquart

**qui suis-je ? je suis le fondateur de qu√©bec.**  
- samuel de champlain

**que suis-je ? je suis le r√©seau commercial cr√©√© en 1670 qui implique la colonie, la france et les antilles fran√ßaises.**  
- le commerce triangulaire

**qui suis-je ? je suis le personnage qui a pris possession de la louisiane au nom du roi de france.**  
- ren√©-robert cavelier de la salle

**quelles sont les deux premi√®res causes qui permettent d‚Äôexpliquer la diminution de la population autochtone durant le r√©gime fran√ßais ?**  
- les maladies et les guerres

**que suis-je ? je suis le terme utilis√© pour d√©signer les membres d‚Äôune communaut√© religieuse qui ont pour mission de convertir des gens au christianisme.**  
- les missionnaires

**que suis-je ? je suis le r√©gime politique dans lequel le chef de l‚Äô√©tat d√©tient un pouvoir total et absolu qui, selon une croyance religieuse, lui vient directement de dieu.**  
- l‚Äôabsolutisme de droit divin

**que suis-je ? utilis√© dans le cadre de la traite des fourrures, je suis un produit d‚Äô√©change ayant fait l‚Äôobjet de vives critiques de la part des autorit√©s religieuses de la colonie.**  
- l‚Äôeau-de-vie (alcool)

**en 1665, la france a envoy√© des soldats d‚Äô√©lite dans la colonie pour mettre un frein √† la menace iroquoise. combien de soldats y ont √©t√© envoy√©s ?**  
- environ 1200

**qui suis-je ? j‚Äôai √©t√© le premier √©v√™que de la colonie durant le r√©gime fran√ßais.**  
- fran√ßois de montmorency-laval (mgr de laval)

**apr√®s le d√©part du premier intendant √† avoir exerc√© ses fonctions dans la colonie, quel a √©t√© le principal facteur d‚Äôaccroissement de la population ?**  
- la natalit√© √©lev√©e

**qui suis-je ? achev√©e en 1737, je suis la premi√®re route carrossable qui permettait de relier les villes de qu√©bec, trois-rivi√®res et montr√©al.**  
- le chemin du roy

**qui suis-je ? je suis un village qui a √©t√© attaqu√© et br√ªl√© par un groupe de 1500 guerriers iroquois le 5 ao√ªt 1689.**  
- le village de lachine (pr√®s de ville-marie)

**qui sont les deux personnages √† l‚Äôorigine de la fondation de la soci√©t√© de notre-dame de montr√©al pour la conversion des sauvages de la nouvelle-france ?**  
- j√©r√¥me le royer de la dauversi√®re et jean-jacques olier

**√† quelle partie du r√©gime fran√ßais doit-on associer la pr√©sence de l‚Äôintendant ?**  
- √† la deuxi√®me partie (1663 √† 1760)

**qui suis-je ? je suis un des membres influents du conseil souverain et je dirige l‚Äô√©glise catholique dans la colonie.**  
- l‚Äô√©v√™que

**que suis-je ? je suis la politique √©conomique selon laquelle une m√©tropole doit accumuler des m√©taux pr√©cieux, surtout de l‚Äôor, en exportant des produits manufactur√©s faits √† partir des mati√®res premi√®res provenant de ses colonies.**  
- le mercantilisme

**que suis-je ? je suis le terme utilis√© pour d√©signer un colon qui a re√ßu une terre √† cultiver de la part d‚Äôun seigneur.**  
- un censitaire

**quelles sont les deux causes ayant contribu√© au d√©veloppement d‚Äôun sentiment d‚Äôind√©pendance chez les canadiens durant le r√©gime fran√ßais ?**  
- l‚Äô√©loignement de la m√©tropole et le contact avec les autochtones

**comment appelait-on les autochtones convertis au catholicisme qui se sont √©tablis sur les terres des seigneuries de la vall√©e du saint-laurent ?**  
- les domicili√©s

**√† quel intendant doit-on la mise en service de la premi√®re brasserie (endroit o√π est brass√©e la bi√®re) dans la colonie ?**  
- jean talon

**qui suis-je ? je suis celui qu‚Äôon a surnomm√© le ¬´ roi-soleil ¬ª et j‚Äôai r√©gn√© pendant plus d‚Äôun demi-si√®cle en ma√Ætre absolu sur le royaume de france et ses colonies.**  
- louis xiv

**que suis-je ? fond√© en 1713, je suis un √©tablissement situ√© √† la pointe est de l‚Äô√Æle royale (actuelle √Æle du cap-breton) qui est devenu, en 1740, un des ports les plus fr√©quent√©s d‚Äôam√©rique du nord.**  
- louisbourg

**qui suis-je ? je suis l‚Äôhomme politique fran√ßais qui est √† l‚Äôorigine de la cr√©ation de la compagnie des cent-associ√©s.**  
- le cardinal de richelieu

**que suis-je ? durant la deuxi√®me partie du r√©gime fran√ßais, dans la colonie, je suis l‚Äôinstitution qui applique les directives du roi et qui conseille les dirigeants coloniaux.**  
- le conseil souverain
`;

            sourceBtn.addEventListener('click', () => {
                // Convertir le markdown en HTML et ajouter la classe pour le style
                sourceContent.innerHTML = `<div class="markdown-content">${md.render(sourceText)}</div>`;
                sourceDialog.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
            });

            closeDialog.addEventListener('click', () => {
                sourceDialog.classList.add('hidden');
                document.body.style.overflow = 'auto';
            });

            sourceDialog.addEventListener('click', (e) => {
                if (e.target === sourceDialog) {
                    sourceDialog.classList.add('hidden');
                    document.body.style.overflow = 'auto';
                }
            });
        });
    </script>
</body>
</html>