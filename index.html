<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Interactif</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800">
    <div class="container mx-auto p-4">
        <div class="bg-white shadow-lg rounded-lg p-6 max-w-xl mx-auto">
            <h1 class="text-2xl font-bold text-center text-blue-600">Quiz Interactif</h1>
            <div class="progress-bar bg-gray-200 rounded-full h-4 mt-4">
                <div id="progress" class="bg-blue-500 h-4 rounded-full transition-all duration-300" style="width: 0%"></div>
            </div>
            <div class="flex justify-between text-sm text-gray-600 mt-1">
                <span id="current-score">0 points</span>
                <span id="max-score">/ 15 points</span>
            </div>
            <div id="quiz">
                <div class="question text-lg font-semibold mt-4" id="question">Question</div>
                <div class="timer text-sm font-bold text-red-600 text-center mt-2" id="timer"></div>
                <div class="choices mt-4 space-y-2" id="choices"></div>
                <div class="score text-xl font-bold text-green-600 text-center mt-6 hidden" id="score"></div>
                <button class="bg-blue-500 text-white px-4 py-2 rounded mt-6 w-full hover:bg-blue-600 transition-colors" id="restart">Recommencer le quiz</button>
            </div>
        </div>
    </div>
    <script>
        const questions = [
        {
            "question": "Quelle invention a permis aux quartiers éloignés du centre-ville de se développer pendant la Belle Époque?",
            "choices": [
            "Le tramway",
            "L'automobile",
            "La bicyclette", 
            "L'avion"
            ],
            "correct": 0
        },
        {
            "question": "En quelle année Alphonse Desjardins a-t-il créé la première Caisse populaire?",
            "choices": [
            "1914",
            "1900",
            "1918",
            "1929"
            ],
            "correct": 1
        },
        {
            "question": "Pourquoi Alphonse Desjardins a-t-il créé la Caisse populaire?",
            "choices": [
            "Car les banques refusaient de prêter aux agriculteurs",
            "Pour enrichir les hommes d'affaires",
            "Pour développer l'urbanisation",
            "Pour aider pendant la guerre"
            ],
            "correct": 0
        },
        {
            "question": "Quand s'est terminée la Première Guerre mondiale?",
            "choices": [
            "4 août 1914",
            "24 octobre 1929",
            "11 novembre 1918",
            "1900"
            ],
            "correct": 2
        },
        {
            "question": "Quelle était l'opinion des francophones concernant leur participation à la guerre?",
            "choices": [
            "Ils étaient contre car elle ne les concernait pas",
            "Ils voulaient soutenir la Grande-Bretagne",
            "Ils étaient tous volontaires",
            "Ils n'avaient pas d'opinion"
            ],
            "correct": 0
        },
        {
            "question": "Quels changements caractérisent les Années folles?",
            "choices": [
            "Les salaires diminuent",
            "Les prix augmentent",
            "Les heures de travail augmentent",
            "Les conditions de vie s'améliorent"
            ],
            "correct": 3
        },
        {
            "question": "Quel événement a déclenché la Grande Crise en 1929?",
            "choices": [
            "La chute de la Bourse de New York",
            "La fin de la Première Guerre mondiale",
            "L'invention de l'automobile",
            "La création des Caisses populaires"
            ],
            "correct": 0
        },
        {
            "question": "Quelle était la durée de la Grande Crise?",
            "choices": [
            "5 ans",
            "10 ans",
            "15 ans",
            "20 ans"
            ],
            "correct": 1
        },
        {
            "question": "Que distribuaient les organismes de charité pendant la Grande Crise?",
            "choices": [
            "De l'argent et des maisons",
            "Des vêtements et de la nourriture",
            "Des emplois et des voitures",
            "Des médicaments"
            ],
            "correct": 1
        },
        {
            "question": "Pendant la Belle Époque, quelle invention a permis d'améliorer l'éclairage des rues?",
            "choices": [
            "L'électricité",
            "Le téléphone",
            "L'automobile",
            "La bicyclette"
            ],
            "correct": 0
        },
        {
            "question": "Quand s'est terminée la Belle Époque?",
            "choices": [
            "En 1900",
            "En 1914",
            "En 1918",
            "En 1929"
            ],
            "correct": 1
        },
        {
            "question": "Quelle nouvelle classe de travailleurs est apparue pendant les Années folles?",
            "choices": [
            "Les agriculteurs",
            "Les soldats",
            "Les employés de bureau et de magasins",
            "Les infirmières"
            ],
            "correct": 2
        },
        {
            "question": "Que faisaient les gouvernements pour aider les gens pendant la Grande Crise?",
            "choices": [
            "Ils offraient des coupons pour la nourriture et organisaient des travaux publics",
            "Ils fermaient les usines",
            "Ils augmentaient les impôts",
            "Ils envoyaient les gens à la guerre"
            ],
            "correct": 0
        },
        {
            "question": "Quelles inégalités les femmes subissaient-elles dans les années 1920?",
            "choices": [
            "Elles étaient mieux payées que les hommes",
            "Elles n'avaient pas le droit de vote et étaient moins bien payées",
            "Elles ne pouvaient pas aller à l'école",
            "Elles ne pouvaient pas vivre en ville"
            ],
            "correct": 1
        },
        {
            "question": "Quel phénomène décrit le fait que beaucoup de personnes partent vivre en ville au début du 20e siècle?",
            "choices": [
            "L'urbanisation",
            "L'industrialisation",
            "La modernisation",
            "La migration"
            ],
            "correct": 0
        }
        ];

        const shuffledQuestions = [...questions].sort(() => Math.random() - 0.5);

        const questionElement = document.getElementById("question");
        const choicesElement = document.getElementById("choices");
        const scoreElement = document.getElementById("score");
        const restartButton = document.getElementById("restart");
        const timerElement = document.getElementById("timer");

        let currentQuestionIndex = 0;
        let score = 0;
        let countdown;

        function updateProgressBar() {
            const progressBar = document.getElementById("progress");
            const currentScoreElement = document.getElementById("current-score");
            const percentage = (score / shuffledQuestions.length) * 100;
            progressBar.style.width = `${percentage}%`;
            currentScoreElement.textContent = `${score} points`;
        }

        function showQuestion() {
            const question = shuffledQuestions[currentQuestionIndex];
            questionElement.textContent = question.question;
            choicesElement.innerHTML = "";
            timerElement.textContent = "Temps restant : 20 secondes";
            let timeLeft = 20;

            // Start countdown
            countdown = setInterval(() => {
                timeLeft--;
                timerElement.textContent = `Temps restant : ${timeLeft} secondes`;
                if (timeLeft <= 0) {
                    clearInterval(countdown);
                    checkAnswer(-1); // Timeout: No answer selected
                }
            }, 1000);

            question.choices.forEach((choice, index) => {
                const button = document.createElement("div");
                button.textContent = choice;
                button.classList.add(
                    "choice",
                    "bg-gray-200",
                    "px-4",
                    "py-2",
                    "rounded",
                    "hover:bg-blue-300",
                    "cursor-pointer",
                    "transition"
                );
                button.addEventListener("click", () => checkAnswer(index));
                choicesElement.appendChild(button);
            });
        }

        function checkAnswer(selected) {
            clearInterval(countdown);
            const question = shuffledQuestions[currentQuestionIndex];
            const buttons = document.querySelectorAll(".choice");
            if (selected === question.correct) {
                buttons[selected]?.classList.add("bg-green-400");
                score++;
                updateProgressBar();
            } else if (selected !== -1) {
                buttons[selected]?.classList.add("bg-red-400");
                buttons[question.correct]?.classList.add("bg-green-400");
            } else {
                // Timeout case: highlight correct answer
                buttons[question.correct]?.classList.add("bg-green-400");
            }
            buttons.forEach((button) => (button.style.pointerEvents = "none"));
            currentQuestionIndex++;
            setTimeout(() => {
                if (currentQuestionIndex < shuffledQuestions.length) {
                    showQuestion();
                } else {
                    showScore();
                }
            }, 1000);
        }

        function showScore() {
            questionElement.style.display = "none";
            choicesElement.style.display = "none";
            timerElement.style.display = "none";
            scoreElement.style.display = "block";
            scoreElement.textContent = `Votre score : ${score} / ${shuffledQuestions.length}`;
            restartButton.style.display = "block";
        }

        restartButton.addEventListener("click", () => {
            currentQuestionIndex = 0;
            score = 0;
            questionElement.style.display = "block";
            choicesElement.style.display = "flex";
            timerElement.style.display = "block";
            scoreElement.style.display = "none";
            restartButton.style.display = "none";
            updateProgressBar();
            showQuestion();
        });

        showQuestion();
    </script>
</body>
</html>